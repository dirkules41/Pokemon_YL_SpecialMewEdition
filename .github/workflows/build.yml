name: Build ROM

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ Checkout repo
      uses: actions/checkout@v3

    - name: ğŸ› ï¸ Install dependencies
      run: |
        sudo apt update
        sudo apt install -y build-essential git libpng-dev cmake

    - name: ğŸ”§ Build RGBDS v0.6.1 from source
      run: |
        git clone https://github.com/gbdev/rgbds.git
        cd rgbds
        git checkout v0.6.1
        make
        sudo make install
        rgbasm -V  # Version anzeigen zur Sicherheit

    - name: ğŸ”¨ Build ROM
      run: |
        make clean
        make
        mv pokeyellow.gbc "PKM YL Mew Edition Vx.x.gbc"

    - name: ğŸ“¦ Upload ROM Artifact
      uses: actions/upload-artifact@v4
      with:
        name: PKM-YL-MEW-ROM
        path: '*.gbc'
